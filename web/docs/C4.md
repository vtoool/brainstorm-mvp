# Green Needle – C4 Model

## Level 1 – Context
```
C4Context
title Green Needle Context
Person(user, "Creator", "Captures ideas and runs tournaments")
System(webapp, "Green Needle Web App", "Next.js front-end")
System_Ext(supabase, "Supabase", "Auth, PostgREST, Realtime (future)")
user -> webapp : Captures ideas, manages tournaments
webapp -> supabase : Persist ideas, tournaments, votes (future)
```

## Level 2 – Containers
```
C4Container
title Containers
Person(user, "Creator")
System_Boundary(app, "Green Needle") {
  Container(browser, "Browser", "React UI", "Routes, components, client state")
  Container(server, "Next.js Server", "SSR/ISR", "App Router layouts, metadata")
  Container(spa, "Mock Data Adapter", "LocalStorage", "In-memory store for ideas/tournaments")
}
System_Ext(vercel, "Vercel", "Hosting")
System_Ext(supabase, "Supabase", "Auth + PostgREST + Realtime (planned)")
user -> browser : Interacts with UI
browser -> spa : CRUD via dataPort
browser -> server : Initial HTML/metadata
server -> vercel : Deploy target
browser -.-> supabase : Future API calls
```

## Level 3 – Components
```
C4Component
title Web App Components
Container_Boundary(browser, "Browser") {
  Component(nav, "App Layout", "Header, navigation, theme shell")
  Component(ideas, "Ideas UI", "Idea list, optimistic add/delete")
  Component(tlist, "Tournament List", "Table of tournaments")
  Component(twizard, "Tournament Wizard", "3-step creation flow")
  Component(bracket, "Bracket Viewer", "Single-elimination editor")
  Component(room, "Voting Room", "Keyboard voting mock")
  Component(settings, "Settings", "Theme + local reset")
  Component(dataPort, "dataPort", "Adapter gateway")
}
Component(mockAdapter, "MockDataAdapter", "LocalStorage-backed repository")
Component(supabaseStub, "SupabaseAdapterStub", "Placeholder for future integration")
nav -> dataPort
ideas -> dataPort
tlist -> dataPort
twizard -> dataPort
bracket -> dataPort
room -> dataPort
settings -> dataPort
```

## Level 4 – Code/Key Modules
```
C4Component
title Key Modules
Component(dataPort, "dataPort", "src/lib/data.ts", "Exports mock port")
Component(types, "Domain Types", "src/lib/domain/types.ts", "Shared types")
Component(mock, "Mock Adapter", "src/lib/adapters/mockDataAdapter.ts", "Implements DataPort")
Component(bracket, "Bracket Utils", "src/lib/bracket/generate.ts", "Generate + update brackets")
Component(ideasHook, "useIdeas", "src/app/ideas/useIdeas.ts", "Idea state management")
Component(tournamentPage, "Tournament Detail", "src/app/t/[id]/page.tsx", "Bracket UI")
Component(roomPage, "Voting Room", "src/app/room/[code]/page.tsx", "Vote interactions")
Component(theme, "Theme Provider", "src/components/theme/ThemeProvider.tsx", "Theme context")
dataPort --> mock
mock --> bracket
ideasHook --> dataPort
tournamentPage --> dataPort
tournamentPage --> bracket
roomPage --> dataPort
```
